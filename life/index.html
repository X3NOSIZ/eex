<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Canvas Life</title>
  <link href="favicon.ico" rel="shortcut icon" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Martel+Sans:200|Space+Mono" rel="stylesheet">
  <style type="text/css">
    /*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
    html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}
    * {
      box-sizing: border-box;
    }
    html {
      background: #121717;
    }
    html, body {
      width: 100%;
      height: 100%;
    }
    #about {
      position: absolute;
      left: 50%;
      bottom: 40px;
      margin-left: -200px;
      width: 400px;
      line-height: 1;
      z-index: 3;
    }
    #about > div {
      opacity: 0;
      transition: 1s ease all;
    }
    #about > div.visible {
      opacity: 1;
    }
    #about-title {
      padding-bottom: 10px;
      color: #fffc00;
      font-size: 20px;
      font-family: 'Martel Sans', sans-serif;
      text-transform: uppercase;
    }
    #about-desc {
      color: #ccc900;
      font-size: 10px;
      font-family: 'Space Mono', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    #about-cred {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #71725d;
      color: #71725d;
      font-size: 10px;
      font-family: 'Space Mono', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      line-height: 1.3;
    }
    a, a:visited {
      color: #71725d;
      text-decoration: underline;
    }
    a:hover {
      cursor: pointer;
      text-decoration: none;
    }
    #life {
      cursor: pointer;
      overflow: hidden;
      position: absolute;
      opacity: 0;
      top: 50%;
      left: 50%;
      margin: -200px 0 0 -200px;
      width: 400px;
      height: 400px;
      transition: 1s ease all;
    }
    #life.visible {
      opacity: 1;
    }
    @media (max-width : 730px) {
      #life {
        overflow: hidden;
        left: 0;
        margin-left: 0;
        width: 100%;
      }
      #about {
        left: 0;
        margin-left: 0;
        padding: 0 40px;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div id="about">
    <div id="about-title">
      Canvas Life
    </div>
    <div id="about-desc">
      Mouse over to interact. Click to toggle zoom.
    </div>
    <div id="about-cred">
      <div>Built by <a href="https://github.com/tofuness">Dennis Jin</a> — <a href="https://dennisjin.com/">dennisjin.com</a></div>
      <div><a href="https://github.com/tofuness/eex">Source code on Github</a> — <a href="http://tofuness.github.io/eex/">View more eexperiments</a></div>
    </div>
  </div>
  <div id="life"></div>
  <!-- Using a custom lodash build, built with following command: -->
  <!-- lodash include=get,set exports=global -->
  <script src="lodash.js"></script>
  <script src="pt.js"></script>
  <script type="text/javascript">
    // Lots of inspiration/code from the circle.intersectPoint and grid.canFit demos for Pt.js
    // http://williamngan.github.io/pt/demo/index.html?name=circle.intersectPoint
    // http://williamngan.github.io/pt/demo/index.html?name=grid.canFit
    window.onload = function() {
      var universe = {};
      var countTimesBorn = false;

      var zoomTarget = 1;
      var zoomCurrent = 1;

      var space = new CanvasSpace('pt').display('#life').autoResize(false);
      space.refresh(false);

      var form = new Form(space);
      form.stroke('transparent', 0);

      var grid = new Grid(space.size.$multiply(0)).to(space.size).init(3, 3, 'fix', 'fix');
      var mouse = new Circle(space.size.$multiply(0)).setRadius(1);
      var anchor = mouse.clone();

      var oscillators = {
        // Double X
        doubleX: [[-64,-31],[-63,-31],[63,-31],[64,-31],[-64,-30],[-63,-30],[63,-30],[64,-30],[-58,-29],[-57,-29],[-56,-29],[56,-29],[57,-29],[58,-29],[-59,-28],[-55,-28],[55,-28],[59,-28],[-59,-27],[-58,-27],[-56,-27],[-55,-27],[-13,-27],[-12,-27],[12,-27],[13,-27],[55,-27],[56,-27],[58,-27],[59,-27],[-35,-26],[-34,-26],[-14,-26],[-13,-26],[-12,-26],[-11,-26],[11,-26],[12,-26],[13,-26],[14,-26],[34,-26],[35,-26],[-59,-25],[-58,-25],[-56,-25],[-55,-25],[-37,-25],[-36,-25],[-34,-25],[-33,-25],[-14,-25],[-13,-25],[-11,-25],[-10,-25],[10,-25],[11,-25],[13,-25],[14,-25],[33,-25],[34,-25],[36,-25],[37,-25],[55,-25],[56,-25],[58,-25],[59,-25],[-57,-24],[-37,-24],[-36,-24],[-35,-24],[-34,-24],[-12,-24],[-11,-24],[11,-24],[12,-24],[34,-24],[35,-24],[36,-24],[37,-24],[57,-24],[-49,-23],[-48,-23],[-36,-23],[-35,-23],[35,-23],[36,-23],[48,-23],[49,-23],[-49,-22],[-47,-22],[47,-22],[49,-22],[-49,-21],[49,-21],[-64,-20],[-56,-20],[56,-20],[64,-20],[-65,-19],[-62,-19],[-58,-19],[-55,-19],[-9,-19],[-7,-19],[7,-19],[9,-19],[55,-19],[58,-19],[62,-19],[65,-19],[-61,-18],[-59,-18],[-9,-18],[-8,-18],[8,-18],[9,-18],[59,-18],[61,-18],[-61,-17],[-59,-17],[-8,-17],[8,-17],[59,-17],[61,-17],[-61,-16],[-59,-16],[59,-16],[61,-16],[-65,-15],[-62,-15],[-58,-15],[-55,-15],[55,-15],[58,-15],[62,-15],[65,-15],[-64,-14],[-63,-14],[-62,-14],[-58,-14],[-57,-14],[-56,-14],[56,-14],[57,-14],[58,-14],[62,-14],[63,-14],[64,-14],[-38,-11],[-37,-11],[-36,-11],[36,-11],[37,-11],[38,-11],[-38,-10],[38,-10],[-37,-9],[37,-9],[-19,-8],[19,-8],[-21,-7],[-20,-7],[20,-7],[21,-7],[-20,-6],[-19,-6],[19,-6],[20,-6],[-64,-4],[-63,-4],[63,-4],[64,-4],[-64,-3],[-63,-3],[63,-3],[64,-3],[-26,0],[-25,0],[25,0],[26,0],[-26,1],[-24,1],[24,1],[26,1],[-26,2],[26,2],[-64,3],[-63,3],[63,3],[64,3],[-64,4],[-63,4],[-32,4],[-30,4],[30,4],[32,4],[63,4],[64,4],[-58,5],[-57,5],[-56,5],[-32,5],[-31,5],[31,5],[32,5],[56,5],[57,5],[58,5],[-59,6],[-55,6],[-31,6],[31,6],[55,6],[59,6],[-59,7],[-58,7],[-56,7],[-55,7],[55,7],[56,7],[58,7],[59,7],[-59,9],[-58,9],[-56,9],[-55,9],[55,9],[56,9],[58,9],[59,9],[-57,10],[57,10],[-15,12],[-14,12],[-13,12],[13,12],[14,12],[15,12],[-15,13],[15,13],[-64,14],[-56,14],[-14,14],[14,14],[56,14],[64,14],[-65,15],[-62,15],[-58,15],[-55,15],[-42,15],[42,15],[55,15],[58,15],[62,15],[65,15],[-61,16],[-59,16],[-44,16],[-43,16],[43,16],[44,16],[59,16],[61,16],[-61,17],[-59,17],[-43,17],[-42,17],[42,17],[43,17],[59,17],[61,17],[-61,18],[-59,18],[59,18],[61,18],[-65,19],[-62,19],[-58,19],[-55,19],[55,19],[58,19],[62,19],[65,19],[-64,20],[-63,20],[-62,20],[-58,20],[-57,20],[-56,20],[56,20],[57,20],[58,20],[62,20],[63,20],[64,20],[-49,23],[-46,23],[-3,23],[-2,23],[2,23],[3,23],[46,23],[49,23],[-45,24],[-25,24],[-24,24],[-23,24],[-22,24],[-3,24],[-1,24],[1,24],[3,24],[22,24],[23,24],[24,24],[25,24],[45,24],[-49,25],[-45,25],[-26,25],[-22,25],[-3,25],[3,25],[22,25],[26,25],[45,25],[49,25],[-48,26],[-47,26],[-46,26],[-45,26],[-22,26],[22,26],[45,26],[46,26],[47,26],[48,26],[-26,27],[-23,27],[23,27],[26,27],[-64,30],[-63,30],[63,30],[64,30],[-64,31],[-63,31],[63,31],[64,31]],
        // Light Speed 1
        lightspeed1: [[-12,-9],[-11,-9],[9,-9],[12,-9],[-12,-8],[-10,-8],[9,-8],[10,-8],[11,-8],[12,-8],[-10,-7],[-6,-7],[-3,-7],[0,-7],[3,-7],[6,-7],[13,-7],[14,-7],[30,-7],[31,-7],[-11,-6],[-10,-6],[-8,-6],[-7,-6],[-6,-6],[-5,-6],[-4,-6],[-3,-6],[-2,-6],[-1,-6],[0,-6],[1,-6],[2,-6],[3,-6],[4,-6],[5,-6],[6,-6],[7,-6],[8,-6],[9,-6],[10,-6],[11,-6],[12,-6],[15,-6],[17,-6],[18,-6],[20,-6],[23,-6],[26,-6],[30,-6],[-16,-5],[-15,-5],[-12,-5],[-9,-5],[14,-5],[18,-5],[20,-5],[21,-5],[22,-5],[23,-5],[26,-5],[27,-5],[28,-5],[30,-5],[-20,-4],[-19,-4],[-17,-4],[-15,-4],[-12,-4],[-11,-4],[-8,-4],[-7,-4],[-6,-4],[-3,-4],[-2,-4],[-1,-4],[2,-4],[3,-4],[4,-4],[7,-4],[8,-4],[9,-4],[12,-4],[13,-4],[15,-4],[16,-4],[24,-4],[25,-4],[29,-4],[31,-4],[32,-4],[-33,-3],[-32,-3],[-29,-3],[-28,-3],[-24,-3],[-23,-3],[-19,-3],[-17,-3],[-10,-3],[-9,-3],[-4,-3],[-3,-3],[1,-3],[2,-3],[6,-3],[7,-3],[13,-3],[15,-3],[17,-3],[18,-3],[19,-3],[20,-3],[21,-3],[24,-3],[27,-3],[31,-3],[34,-3],[-33,-2],[-29,-2],[-27,-2],[-24,-2],[-20,-2],[-16,-2],[-12,-2],[-11,-2],[-8,-2],[-7,-2],[-3,-2],[-2,-2],[-1,-2],[2,-2],[3,-2],[4,-2],[7,-2],[8,-2],[9,-2],[11,-2],[12,-2],[16,-2],[20,-2],[25,-2],[27,-2],[28,-2],[31,-2],[33,-2],[34,-2],[-32,-1],[-31,-1],[-30,-1],[-27,-1],[-23,-1],[-20,-1],[-19,-1],[-18,-1],[-17,-1],[-16,-1],[-13,-1],[-8,-1],[12,-1],[18,-1],[19,-1],[20,-1],[21,-1],[24,-1],[30,-1],[31,-1],[-30,0],[-28,0],[-26,0],[-25,0],[-24,0],[-23,0],[-17,0],[-16,0],[-12,0],[-10,0],[-8,0],[-7,0],[-3,0],[-2,0],[-1,0],[2,0],[3,0],[4,0],[7,0],[8,0],[9,0],[11,0],[12,0],[16,0],[20,0],[25,0],[27,0],[28,0],[31,0],[33,0],[34,0],[-28,1],[-26,1],[-22,1],[-21,1],[-20,1],[-19,1],[-18,1],[-15,1],[-12,1],[-4,1],[-3,1],[1,1],[2,1],[6,1],[7,1],[13,1],[15,1],[17,1],[18,1],[19,1],[20,1],[21,1],[24,1],[27,1],[31,1],[34,1],[-28,2],[-25,2],[-23,2],[-16,2],[-14,2],[-12,2],[-11,2],[-10,2],[-9,2],[-8,2],[-7,2],[-6,2],[-3,2],[-2,2],[-1,2],[2,2],[3,2],[4,2],[7,2],[8,2],[9,2],[12,2],[13,2],[15,2],[16,2],[24,2],[25,2],[29,2],[31,2],[32,2],[-31,3],[-28,3],[-25,3],[-22,3],[-20,3],[-17,3],[-16,3],[-15,3],[-14,3],[-12,3],[14,3],[18,3],[20,3],[21,3],[22,3],[23,3],[26,3],[27,3],[28,3],[30,3],[-31,4],[-30,4],[-28,4],[-26,4],[-25,4],[-20,4],[-12,4],[-10,4],[-9,4],[-8,4],[-7,4],[-6,4],[-5,4],[-4,4],[-3,4],[-2,4],[-1,4],[0,4],[1,4],[2,4],[3,4],[4,4],[5,4],[6,4],[7,4],[8,4],[9,4],[10,4],[11,4],[12,4],[15,4],[17,4],[18,4],[20,4],[23,4],[26,4],[30,4],[-31,5],[-29,5],[-25,5],[-23,5],[-18,5],[-17,5],[-16,5],[-15,5],[-14,5],[-13,5],[-11,5],[-6,5],[-3,5],[0,5],[3,5],[6,5],[13,5],[14,5],[30,5],[31,5],[-33,6],[-31,6],[-29,6],[-27,6],[-26,6],[-23,6],[-22,6],[-21,6],[-20,6],[-19,6],[-13,6],[-11,6],[-9,6],[9,6],[10,6],[11,6],[12,6],[-34,7],[-32,7],[-28,7],[-25,7],[-24,7],[-19,7],[-17,7],[-16,7],[-13,7],[-10,7],[-9,7],[9,7],[12,7],[-33,8],[-27,8],[-25,8],[-22,8],[-18,8],[-17,8],[-15,8],[-13,8],[-26,9],[-23,9],[-22,9],[-14,9]],
        // Light Speed 2
        lightspeed2: [[16,-12],[17,-12],[20,-12],[21,-12],[16,-11],[18,-11],[21,-11],[22,-11],[23,-11],[10,-10],[12,-10],[13,-10],[18,-10],[19,-10],[24,-10],[33,-10],[34,-10],[-17,-9],[-16,-9],[-13,-9],[-12,-9],[-10,-9],[-9,-9],[7,-9],[10,-9],[11,-9],[13,-9],[17,-9],[20,-9],[21,-9],[24,-9],[32,-9],[35,-9],[-18,-8],[-15,-8],[-12,-8],[-10,-8],[7,-8],[8,-8],[9,-8],[14,-8],[15,-8],[18,-8],[22,-8],[24,-8],[25,-8],[31,-8],[34,-8],[35,-8],[-19,-7],[-17,-7],[-16,-7],[-12,-7],[-8,-7],[-5,-7],[-2,-7],[1,-7],[4,-7],[11,-7],[12,-7],[14,-7],[16,-7],[17,-7],[19,-7],[20,-7],[22,-7],[24,-7],[30,-7],[32,-7],[33,-7],[36,-7],[37,-7],[-18,-6],[-15,-6],[-14,-6],[-13,-6],[-11,-6],[-10,-6],[-9,-6],[-8,-6],[-7,-6],[-6,-6],[-5,-6],[-4,-6],[-3,-6],[-2,-6],[-1,-6],[0,-6],[1,-6],[2,-6],[3,-6],[4,-6],[5,-6],[6,-6],[7,-6],[8,-6],[9,-6],[10,-6],[12,-6],[17,-6],[19,-6],[21,-6],[22,-6],[25,-6],[30,-6],[34,-6],[38,-6],[-20,-5],[-18,-5],[-16,-5],[-13,-5],[-11,-5],[13,-5],[17,-5],[20,-5],[21,-5],[23,-5],[27,-5],[28,-5],[30,-5],[34,-5],[35,-5],[36,-5],[39,-5],[-20,-4],[-19,-4],[-16,-4],[-14,-4],[-9,-4],[-8,-4],[-5,-4],[-4,-4],[-3,-4],[0,-4],[1,-4],[2,-4],[5,-4],[6,-4],[7,-4],[10,-4],[11,-4],[12,-4],[16,-4],[17,-4],[20,-4],[27,-4],[28,-4],[34,-4],[35,-4],[37,-4],[39,-4],[42,-4],[-16,-3],[-14,-3],[-11,-3],[-9,-3],[-8,-3],[-7,-3],[-3,-3],[-2,-3],[2,-3],[3,-3],[7,-3],[8,-3],[16,-3],[17,-3],[20,-3],[21,-3],[35,-3],[36,-3],[37,-3],[40,-3],[41,-3],[42,-3],[-38,-2],[-20,-2],[-19,-2],[-18,-2],[-17,-2],[-12,-2],[-8,-2],[-5,-2],[-4,-2],[-3,-2],[0,-2],[1,-2],[2,-2],[5,-2],[6,-2],[7,-2],[11,-2],[15,-2],[21,-2],[35,-2],[38,-2],[39,-2],[-39,-1],[-37,-1],[-20,-1],[-16,-1],[-15,-1],[-14,-1],[-13,-1],[-12,-1],[11,-1],[15,-1],[16,-1],[35,-1],[36,-1],[37,-1],[40,-1],[-40,0],[-38,0],[-17,0],[-14,0],[-11,0],[-9,0],[-8,0],[-7,0],[-6,0],[-5,0],[-4,0],[-3,0],[-2,0],[-1,0],[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,0],[11,0],[14,0],[17,0],[38,0],[40,0],[-40,1],[-37,1],[-36,1],[-35,1],[-16,1],[-15,1],[-11,1],[12,1],[13,1],[14,1],[15,1],[16,1],[20,1],[37,1],[39,1],[-39,2],[-38,2],[-35,2],[-21,2],[-15,2],[-11,2],[-7,2],[-6,2],[-5,2],[-2,2],[-1,2],[0,2],[3,2],[4,2],[5,2],[8,2],[12,2],[17,2],[18,2],[19,2],[20,2],[38,2],[-42,3],[-41,3],[-40,3],[-37,3],[-36,3],[-35,3],[-21,3],[-20,3],[-17,3],[-16,3],[-8,3],[-7,3],[-3,3],[-2,3],[2,3],[3,3],[7,3],[8,3],[9,3],[11,3],[14,3],[16,3],[-42,4],[-39,4],[-37,4],[-35,4],[-34,4],[-28,4],[-27,4],[-20,4],[-17,4],[-16,4],[-12,4],[-11,4],[-10,4],[-7,4],[-6,4],[-5,4],[-2,4],[-1,4],[0,4],[3,4],[4,4],[5,4],[8,4],[9,4],[14,4],[16,4],[19,4],[20,4],[-39,5],[-36,5],[-35,5],[-34,5],[-30,5],[-28,5],[-27,5],[-23,5],[-21,5],[-20,5],[-17,5],[-13,5],[11,5],[13,5],[16,5],[18,5],[20,5],[-38,6],[-34,6],[-30,6],[-25,6],[-22,6],[-21,6],[-19,6],[-17,6],[-12,6],[-10,6],[-9,6],[-8,6],[-7,6],[-6,6],[-5,6],[-4,6],[-3,6],[-2,6],[-1,6],[0,6],[1,6],[2,6],[3,6],[4,6],[5,6],[6,6],[7,6],[8,6],[9,6],[10,6],[11,6],[13,6],[14,6],[15,6],[18,6],[-37,7],[-36,7],[-33,7],[-32,7],[-30,7],[-24,7],[-22,7],[-20,7],[-19,7],[-17,7],[-16,7],[-14,7],[-12,7],[-11,7],[-4,7],[-1,7],[2,7],[5,7],[8,7],[12,7],[16,7],[17,7],[19,7],[-35,8],[-34,8],[-31,8],[-25,8],[-24,8],[-22,8],[-18,8],[-15,8],[-14,8],[-9,8],[-8,8],[-7,8],[10,8],[12,8],[15,8],[18,8],[-35,9],[-32,9],[-24,9],[-21,9],[-20,9],[-17,9],[-13,9],[-11,9],[-10,9],[-7,9],[9,9],[10,9],[12,9],[13,9],[16,9],[17,9],[-34,10],[-33,10],[-24,10],[-19,10],[-18,10],[-13,10],[-12,10],[-10,10],[-23,11],[-22,11],[-21,11],[-18,11],[-16,11],[-21,12],[-20,12],[-17,12],[-16,12]],
        // Light Speed 3
        lightspeed3: [[25,-36],[23,-35],[24,-35],[25,-35],[20,-34],[22,-34],[26,-34],[27,-34],[18,-33],[19,-33],[20,-33],[22,-33],[23,-33],[24,-33],[25,-33],[28,-33],[30,-33],[31,-33],[17,-32],[25,-32],[27,-32],[28,-32],[30,-32],[16,-31],[18,-31],[19,-31],[20,-31],[21,-31],[22,-31],[24,-31],[27,-31],[30,-31],[33,-31],[-22,-30],[-21,-30],[16,-30],[17,-30],[21,-30],[23,-30],[24,-30],[27,-30],[29,-30],[31,-30],[32,-30],[33,-30],[-22,-29],[-21,-29],[14,-29],[15,-29],[19,-29],[28,-29],[30,-29],[13,-28],[15,-28],[17,-28],[18,-28],[20,-28],[29,-28],[32,-28],[33,-28],[-22,-27],[-21,-27],[-20,-27],[-19,-27],[-15,-27],[-14,-27],[13,-27],[16,-27],[18,-27],[20,-27],[26,-27],[30,-27],[31,-27],[32,-27],[34,-27],[-22,-26],[-18,-26],[-15,-26],[14,-26],[16,-26],[19,-26],[20,-26],[25,-26],[27,-26],[34,-26],[-19,-25],[-17,-25],[-15,-25],[15,-25],[18,-25],[19,-25],[26,-25],[32,-25],[33,-25],[35,-25],[36,-25],[-19,-24],[-18,-24],[-17,-24],[-15,-24],[-13,-24],[10,-24],[11,-24],[18,-24],[19,-24],[20,-24],[30,-24],[31,-24],[33,-24],[35,-24],[-17,-23],[-15,-23],[-14,-23],[-12,-23],[10,-23],[12,-23],[18,-23],[19,-23],[30,-23],[33,-23],[35,-23],[-30,-22],[-29,-22],[-27,-22],[-26,-22],[-18,-22],[-12,-22],[12,-22],[15,-22],[16,-22],[31,-22],[33,-22],[34,-22],[-30,-21],[-29,-21],[-27,-21],[-19,-21],[-18,-21],[-16,-21],[-15,-21],[-14,-21],[-13,-21],[-12,-21],[-10,-21],[-9,-21],[9,-21],[12,-21],[13,-21],[14,-21],[15,-21],[16,-21],[30,-21],[31,-21],[-27,-20],[-10,-20],[-9,-20],[9,-20],[10,-20],[11,-20],[16,-20],[24,-20],[26,-20],[27,-20],[28,-20],[31,-20],[33,-20],[34,-20],[-27,-19],[-25,-19],[-24,-19],[-21,-19],[-16,-19],[-14,-19],[-13,-19],[-12,-19],[-6,-19],[-3,-19],[0,-19],[3,-19],[6,-19],[12,-19],[15,-19],[23,-19],[24,-19],[25,-19],[26,-19],[29,-19],[31,-19],[33,-19],[-26,-18],[-24,-18],[-22,-18],[-21,-18],[-17,-18],[-11,-18],[-10,-18],[-9,-18],[-8,-18],[-7,-18],[-6,-18],[-5,-18],[-4,-18],[-3,-18],[-2,-18],[-1,-18],[0,-18],[1,-18],[2,-18],[3,-18],[4,-18],[5,-18],[6,-18],[7,-18],[8,-18],[9,-18],[10,-18],[11,-18],[13,-18],[23,-18],[24,-18],[25,-18],[27,-18],[28,-18],[31,-18],[33,-18],[-25,-17],[-24,-17],[-23,-17],[-18,-17],[-11,-17],[15,-17],[28,-17],[30,-17],[32,-17],[-21,-16],[-19,-16],[-14,-16],[-10,-16],[-7,-16],[-6,-16],[-5,-16],[-2,-16],[-1,-16],[0,-16],[3,-16],[4,-16],[5,-16],[8,-16],[9,-16],[10,-16],[11,-16],[12,-16],[15,-16],[16,-16],[20,-16],[21,-16],[22,-16],[26,-16],[27,-16],[30,-16],[31,-16],[-27,-15],[-26,-15],[-25,-15],[-24,-15],[-23,-15],[-21,-15],[-14,-15],[-10,-15],[-9,-15],[-5,-15],[-4,-15],[0,-15],[1,-15],[5,-15],[6,-15],[11,-15],[16,-15],[17,-15],[19,-15],[21,-15],[22,-15],[25,-15],[28,-15],[29,-15],[-27,-14],[-23,-14],[-21,-14],[-19,-14],[-16,-14],[-15,-14],[-12,-14],[-11,-14],[-10,-14],[-7,-14],[-6,-14],[-5,-14],[-2,-14],[-1,-14],[0,-14],[3,-14],[4,-14],[5,-14],[8,-14],[9,-14],[10,-14],[11,-14],[12,-14],[21,-14],[26,-14],[29,-14],[-24,-13],[-21,-13],[-19,-13],[-12,-13],[18,-13],[21,-13],[27,-13],[28,-13],[-23,-12],[-22,-12],[-21,-12],[-19,-12],[-14,-12],[-13,-12],[-11,-12],[-10,-12],[-9,-12],[-8,-12],[-7,-12],[-6,-12],[-5,-12],[-4,-12],[-3,-12],[-2,-12],[-1,-12],[0,-12],[1,-12],[2,-12],[3,-12],[4,-12],[5,-12],[6,-12],[7,-12],[8,-12],[9,-12],[10,-12],[11,-12],[14,-12],[16,-12],[19,-12],[21,-12],[22,-12],[23,-12],[-18,-11],[-17,-11],[-14,-11],[-12,-11],[-9,-11],[-6,-11],[-3,-11],[0,-11],[3,-11],[6,-11],[9,-11],[12,-11],[14,-11],[15,-11],[16,-11],[18,-11],[20,-11],[24,-11],[-21,-10],[-20,-10],[-18,-10],[-16,-10],[-15,-10],[-14,-10],[-12,-10],[12,-10],[14,-10],[16,-10],[18,-10],[20,-10],[23,-10],[24,-10],[-21,-9],[-20,-9],[-18,-9],[-15,-9],[-12,-9],[-11,-9],[11,-9],[12,-9],[14,-9],[16,-9],[18,-9],[20,-9],[21,-9],[-18,-8],[-12,-8],[12,-8],[14,-8],[16,-8],[18,-8],[-18,-7],[-16,-7],[-14,-7],[-12,-7],[12,-7],[18,-7],[-19,-6],[-18,-6],[-16,-6],[-14,-6],[-12,-6],[-11,-6],[11,-6],[12,-6],[15,-6],[18,-6],[19,-6],[-18,-5],[-16,-5],[-15,-5],[-14,-5],[-12,-5],[12,-5],[14,-5],[15,-5],[16,-5],[18,-5],[-18,-4],[-15,-4],[-12,-4],[12,-4],[14,-4],[16,-4],[18,-4],[-19,-3],[-18,-3],[-12,-3],[-11,-3],[11,-3],[12,-3],[14,-3],[16,-3],[18,-3],[19,-3],[-18,-2],[-16,-2],[-14,-2],[-12,-2],[12,-2],[18,-2],[-18,-1],[-16,-1],[-14,-1],[-12,-1],[12,-1],[15,-1],[18,-1],[-19,0],[-18,0],[-16,0],[-15,0],[-14,0],[-12,0],[-11,0],[11,0],[12,0],[14,0],[15,0],[16,0],[18,0],[19,0],[-18,1],[-15,1],[-12,1],[12,1],[14,1],[16,1],[18,1],[-18,2],[-12,2],[12,2],[14,2],[16,2],[18,2],[-19,3],[-18,3],[-16,3],[-14,3],[-12,3],[-11,3],[11,3],[12,3],[18,3],[19,3],[-18,4],[-16,4],[-14,4],[-12,4],[12,4],[15,4],[18,4],[-18,5],[-16,5],[-15,5],[-14,5],[-12,5],[12,5],[14,5],[15,5],[16,5],[18,5],[-19,6],[-18,6],[-15,6],[-12,6],[-11,6],[11,6],[12,6],[14,6],[16,6],[18,6],[19,6],[-18,7],[-12,7],[12,7],[14,7],[16,7],[18,7],[-18,8],[-16,8],[-14,8],[-12,8],[12,8],[18,8],[-21,9],[-20,9],[-18,9],[-16,9],[-14,9],[-12,9],[-11,9],[11,9],[12,9],[15,9],[18,9],[20,9],[21,9],[-24,10],[-23,10],[-20,10],[-18,10],[-16,10],[-14,10],[-12,10],[12,10],[14,10],[15,10],[16,10],[18,10],[20,10],[21,10],[-24,11],[-20,11],[-18,11],[-16,11],[-15,11],[-14,11],[-12,11],[-9,11],[-6,11],[-3,11],[0,11],[3,11],[6,11],[9,11],[12,11],[14,11],[17,11],[18,11],[-23,12],[-22,12],[-21,12],[-19,12],[-16,12],[-14,12],[-11,12],[-10,12],[-9,12],[-8,12],[-7,12],[-6,12],[-5,12],[-4,12],[-3,12],[-2,12],[-1,12],[0,12],[1,12],[2,12],[3,12],[4,12],[5,12],[6,12],[7,12],[8,12],[9,12],[10,12],[11,12],[13,12],[14,12],[19,12],[21,12],[22,12],[23,12],[-28,13],[-27,13],[-21,13],[-18,13],[12,13],[19,13],[21,13],[24,13],[-29,14],[-26,14],[-21,14],[-12,14],[-11,14],[-10,14],[-9,14],[-8,14],[-5,14],[-4,14],[-3,14],[0,14],[1,14],[2,14],[5,14],[6,14],[7,14],[10,14],[11,14],[12,14],[15,14],[16,14],[19,14],[21,14],[23,14],[27,14],[-29,15],[-28,15],[-25,15],[-22,15],[-21,15],[-19,15],[-17,15],[-16,15],[-11,15],[-6,15],[-5,15],[-1,15],[0,15],[4,15],[5,15],[9,15],[10,15],[14,15],[21,15],[23,15],[24,15],[25,15],[26,15],[27,15],[-31,16],[-30,16],[-27,16],[-26,16],[-22,16],[-21,16],[-20,16],[-16,16],[-15,16],[-12,16],[-11,16],[-10,16],[-9,16],[-8,16],[-5,16],[-4,16],[-3,16],[0,16],[1,16],[2,16],[5,16],[6,16],[7,16],[10,16],[14,16],[19,16],[21,16],[-32,17],[-30,17],[-28,17],[-15,17],[11,17],[18,17],[23,17],[24,17],[25,17],[-33,18],[-31,18],[-28,18],[-27,18],[-25,18],[-24,18],[-23,18],[-13,18],[-11,18],[-10,18],[-9,18],[-8,18],[-7,18],[-6,18],[-5,18],[-4,18],[-3,18],[-2,18],[-1,18],[0,18],[1,18],[2,18],[3,18],[4,18],[5,18],[6,18],[7,18],[8,18],[9,18],[10,18],[11,18],[17,18],[21,18],[22,18],[24,18],[26,18],[-33,19],[-31,19],[-29,19],[-26,19],[-25,19],[-24,19],[-23,19],[-15,19],[-12,19],[-6,19],[-3,19],[0,19],[3,19],[6,19],[12,19],[13,19],[14,19],[16,19],[21,19],[24,19],[25,19],[27,19],[-34,20],[-33,20],[-31,20],[-28,20],[-27,20],[-26,20],[-24,20],[-16,20],[-11,20],[-10,20],[-9,20],[9,20],[10,20],[27,20],[-31,21],[-30,21],[-16,21],[-15,21],[-14,21],[-13,21],[-12,21],[-9,21],[9,21],[10,21],[12,21],[13,21],[14,21],[15,21],[16,21],[18,21],[19,21],[27,21],[29,21],[30,21],[-34,22],[-33,22],[-31,22],[-16,22],[-15,22],[-12,22],[12,22],[18,22],[26,22],[27,22],[29,22],[30,22],[-35,23],[-33,23],[-30,23],[-19,23],[-18,23],[-12,23],[-10,23],[12,23],[14,23],[15,23],[17,23],[-35,24],[-33,24],[-31,24],[-30,24],[-20,24],[-19,24],[-18,24],[-11,24],[-10,24],[13,24],[15,24],[17,24],[18,24],[19,24],[-36,25],[-35,25],[-33,25],[-32,25],[-26,25],[-19,25],[-18,25],[-15,25],[15,25],[17,25],[19,25],[-34,26],[-27,26],[-25,26],[-20,26],[-19,26],[-16,26],[-14,26],[15,26],[18,26],[22,26],[-34,27],[-32,27],[-31,27],[-30,27],[-26,27],[-20,27],[-18,27],[-16,27],[-13,27],[14,27],[15,27],[19,27],[20,27],[21,27],[22,27],[-33,28],[-32,28],[-29,28],[-20,28],[-18,28],[-17,28],[-15,28],[-13,28],[-30,29],[-28,29],[-19,29],[-15,29],[-14,29],[21,29],[22,29],[-33,30],[-32,30],[-31,30],[-29,30],[-27,30],[-24,30],[-23,30],[-21,30],[-17,30],[-16,30],[21,30],[22,30],[-33,31],[-30,31],[-27,31],[-24,31],[-22,31],[-21,31],[-20,31],[-19,31],[-18,31],[-16,31],[-30,32],[-28,32],[-27,32],[-25,32],[-17,32],[-31,33],[-30,33],[-28,33],[-25,33],[-24,33],[-23,33],[-22,33],[-20,33],[-19,33],[-18,33],[-27,34],[-26,34],[-22,34],[-20,34],[-25,35],[-24,35],[-23,35],[-25,36]],
      }

      function addFigure(col, row, pattern) {
        for (var i = 0; i < pattern.length; i++) {
          grid.occupy(col + pattern[i][0], row + pattern[i][1], 1, 1);
        }
      }
      function switchFigure(pattern) {
        universe = {};
        grid.resetLayout();
        addFigure(Math.ceil(grid.columns / 2), Math.ceil(grid.rows / 2), pattern);
        grid.create();
      }
      switchFigure(oscillators.lightspeed3);

      grid.generate(function(size, position, row, column, type, isOccupied) {
        // Generate universe
        if (!_.get(universe, [column, row])) {
          _.set(universe, [column, row], {
            position: {
              column: column,
              row: row
            },
            rectangle: new Rectangle(position).resizeTo({
              x: size.x - 1,
              y: size.y - 1
            }),
            state: !grid.canFit(column, row, 1, 1),
            bornCount: 0
          });
        }
      });
      // We don't use grid.create in our actual animation loop because it is too slow.
      // See universeTick() for the custom implementation
      grid.create();

      console.log('Cols: ' + grid.columns, 'Rows: ' + grid.rows);

      // Conway's. 1234/3 is pretty cool as well.
      var RULE = [[2, 3], [3]];
      var NEIGHBOR_POSITIONS = [
        [-1, -1], [0, -1], [1, -1],
        [-1, 0],         [1, 0],
        [-1, 1], [0, 1], [1, 1]
      ];
      function countNeighbors(column, row) {
        var count = 0;
        for (var i = 0; i < NEIGHBOR_POSITIONS.length; i++) {
          var colToCheck = column + NEIGHBOR_POSITIONS[i][0];
          var rowToCheck = row + NEIGHBOR_POSITIONS[i][1];
          if (
            colToCheck < 0
            || colToCheck > grid.columns
            || rowToCheck < 0
            || rowToCheck > grid.rows
          ) {
            // Invalid cell
          } else if (!grid.canFit(colToCheck, rowToCheck, 1, 1)) {
            count++;
          }
        }
        return count;
      }

      function canSurvive(column, row) {
        return RULE[0].indexOf(countNeighbors(column, row)) > -1;
      }

      function shouldBorn(column, row) {
        return RULE[1].indexOf(countNeighbors(column, row)) > -1;
      }

      function universeTick(updateUniverse) {
        if (updateUniverse) {
          // Set next state
          for (var column = 0; column < grid.columns; column++) {
            for (var row = 0; row < grid.rows; row++) {
              var nextState = !grid.canFit(column, row, 1, 1)
              ? canSurvive(column, row)
              : shouldBorn(column, row);
              // If we want to do some kind of transition, with a rule like 23/23,
              // we can count times a call has been "reborn" and adjust our paint accodingly.
              // This feature is currently not used doe D:
              if (universe[column][row].state !== nextState && countTimesBorn) {
                universe[column][row].bornCount++;
              }

              // Set next state
              universe[column][row].state = nextState;
            }
          }
        }

        // Draw next state
        for (var column = 0; column < grid.columns; column++) {
          for (var row = 0; row < grid.rows; row++) {
            grid.occupy(column, row, 1, 1, universe[column][row].state);
            if (universe[column][row].state) {
              var rectToDraw = universe[column][row].rectangle;
              var sensitivity = Util.lerp(150, 200, zoomCurrent);
              var distance = universe[column][row].rectangle.distance(anchor);
              var scalingFactor = Util.lerp(1, Math.max((sensitivity - distance) / sensitivity * 3.5, 1), zoomCurrent);

              if (zoomCurrent > 0.005) {
                rectToDraw = universe[column][row].rectangle.clone().scale2D(scalingFactor, scalingFactor, anchor);
              }
              var opacity = scalingFactor / (zoomCurrent * 2 + 1);
              form.fill('rgba(250, 240, 0, ' + 1).rect(rectToDraw);
            }
          }
        }
      }

      var debounce = 0;
      var easing = 0.15;
      space.add({
        animate: function(time, fps, ctx) {
          /*
            Debounce calculating next state. We keep
            fps smooth by using universeTick(false)
            which only repaints.
           */
          if (time - debounce > 30) {
            space.clear();
            debounce = time;
            universeTick(true);
          } else {
            space.clear();
            universeTick(false);
          }
          var zoomDelta = zoomTarget - zoomCurrent;
          if (Math.abs(zoomDelta) > 0.005) {
            zoomCurrent += zoomDelta * 0.25;
          }

          var distance = mouse.distance(anchor);
          var delta = mouse.$subtract(anchor).multiply(easing);
          if (distance > 0.5) {
            anchor.moveBy({
              x: delta.x,
              y: delta.y
            });
          }
          form.fill('#000').circle(anchor);
        }
      });

      var ptEl = document.getElementById('life');
      window.addEventListener('mousemove', function(e) {
        mouse.set(e.clientX - ptEl.offsetLeft, e.clientY - ptEl.offsetTop);
      });
      ptEl.addEventListener('click', function(e) {
        zoomTarget = 1 - zoomTarget;
      });
      space.play();

      var revealDelay = 600;
      setTimeout(function() {
        document.querySelector('#life').classList.add('visible');
      }, revealDelay);
      setTimeout(function() {
        document.querySelector('#about-title').classList.add('visible');
      }, revealDelay + 500);
      setTimeout(function() {
        document.querySelector('#about-desc').classList.add('visible');
      }, revealDelay + 600);
      setTimeout(function() {
        document.querySelector('#about-cred').classList.add('visible');
      }, revealDelay + 700);
    }
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-72079615-3', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
